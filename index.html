<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Secure Login</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">

<style>
:root{
  --bg1:#667eea; --bg2:#764ba2;
  --card:#ffffffee; --text:#222;
}
[data-theme="dark"]{
  --bg1:#1e1e2f; --bg2:#12121a;
  --card:#1f1f2e; --text:#eee;
}
*{box-sizing:border-box;font-family:Poppins,sans-serif}
body{
  margin:0;min-height:100vh;display:flex;justify-content:center;align-items:center;
  background:linear-gradient(135deg,var(--bg1),var(--bg2));
  transition:.6s;opacity:0;color:var(--text)
}
body.loaded{opacity:1}

.login-wrapper{width:100%;max-width:420px;text-align:center}
.logo{width:72px;height:72px;margin:auto;border-radius:18px;background:#fff;
display:flex;align-items:center;justify-content:center;font-size:28px;font-weight:600;color:#667eea}
.brand h1{color:#fff;margin:10px 0 4px}
.brand p{color:rgba(255,255,255,.85);font-size:14px;margin-bottom:24px}

.card{
  background:var(--card);padding:36px;border-radius:20px;
  box-shadow:0 30px 60px rgba(0,0,0,.25);
  animation:fadeUp .6s ease
}
@keyframes fadeUp{from{opacity:0;transform:translateY(14px)}}

.field{margin-bottom:18px;text-align:left;position:relative}
.field label{font-size:13px;margin-bottom:6px;display:block;opacity:.7}
.field input{
  width:100%;padding:14px 44px 14px 16px;border-radius:12px;border:1px solid #ccc;
  transition:.2s
}
.field input:focus{outline:none;border-color:#667eea;box-shadow:0 0 0 3px #667eea33}
.toggle{position:absolute;right:14px;top:38px;font-size:13px;color:#667eea;cursor:pointer}

button{
  cursor:pointer;transition:.2s transform,.2s box-shadow,.2s opacity
}
button:hover{transform:translateY(-1px);box-shadow:0 6px 20px rgba(0,0,0,.15)}
button:active{transform:scale(.98);opacity:.9}

.login-btn{
  width:100%;padding:14px;border-radius:14px;border:none;
  background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;
  font-size:16px;display:flex;justify-content:center;gap:10px
}
.spinner{
  width:18px;height:18px;border:2px solid rgba(255,255,255,.4);
  border-top:2px solid #fff;border-radius:50%;
  animation:spin .7s linear infinite;display:none
}
@keyframes spin{to{transform:rotate(360deg)}}

.error{color:crimson;font-size:14px;margin-bottom:10px}
.caps-lock{color:#ff9800;font-size:12px;display:none}
.shake{animation:shake .4s}
@keyframes shake{25%{transform:translateX(-6px)}50%{transform:translateX(6px)}}

.hidden{display:none}

/* CONTENT PAGE */
.content{
  position:fixed;inset:0;background:var(--card);
  padding:30px 20px 80px;overflow-y:auto;opacity:0;transition:.6s
}
.content.show{opacity:1}
.text{max-width:900px;margin:auto;font-size:16px;line-height:1.9;white-space:pre-wrap}
mark{background:#ffeb3b;padding:0 3px}

.topbar{
  max-width:900px;margin:auto  auto 30px;
  display:flex;justify-content:space-between;align-items:center;gap:10px
}
.topbar input{flex:1;padding:10px;border-radius:10px;border:1px solid #ccc}
.toggle-theme{padding:10px 14px;border-radius:10px;border:none}
.logout{margin:40px auto 0;display:block;padding:14px 26px;border-radius:14px;background:#ff4d4d;color:#fff;border:none}

/* Skeleton */
.skeleton{
  max-width:900px;margin:auto
}
.skel{
  height:16px;background:#ddd;border-radius:6px;margin-bottom:12px;
  animation:pulse 1.2s infinite
}
@keyframes pulse{50%{opacity:.4}}

/* Responsive tweaks */
@media(max-width:400px){
  .card{padding:26px}
  .text{font-size:15px}
}
</style>
</head>
<body>

<div class="login-wrapper" id="loginCard">
  <div class="logo">A</div>
  <div class="brand"><h1>Private Access</h1><p>Authorized users only</p></div>

  <div class="card" id="loginBox">
    <div class="error" id="errorMsg"></div>
    <div class="field"><label>Email</label><input id="username" autofocus></div>
    <div class="field"><label>Password</label><input type="password" id="password">
      <span class="toggle" onclick="togglePassword(event)">Show</span></div>
    <div class="caps-lock" id="capsWarning">Caps Lock is ON</div>
    <label><input type="checkbox" id="rememberMe"> Remember me</label><br><br>
    <button class="login-btn" onclick="login()">
      <span id="btnText">Continue</span><div class="spinner" id="spinner"></div>
    </button>
  </div>
</div>

<div class="content hidden" id="contentCard">
  <div class="topbar">
    <input placeholder="Search textâ€¦" oninput="searchText(this.value)">
    <button class="toggle-theme" onclick="toggleTheme()">ðŸŒ“</button>
  </div>

  <div class="skeleton" id="skeleton">
    <div class="skel"></div><div class="skel"></div><div class="skel"></div>
  </div>

  <div class="text hidden" id="mainText">
Happy Birthday!

You might be wondering why I am writing this to you in such a complicated way. I could have just wished you Happy Birthday, or just gave you a card with Happy Birthday written on it. What you might be even more confused about, is why a random person is wishing you Happy Birthday! I donâ€™t even know you well, and you donâ€™t even know me well!

Isnâ€™t it quite surprising that a random person from your Karate/Drawing class has remembered your birthday? Obviously it is (at least I hope so!) on the 15th of January!

It might be surprising, or it might not be surprising for you. Now, why do you think I created this entire website, with passwords, usernames, and this entire web page? You will get to know your answer to this question soon. Now let me come to the point. 

I have a crush on you. 

Yes, it might sound unbelievable, but it is true. The worst you can do at this point is slap me, or maybe even kill me! Who knows! But trust me, if you just start shunning me from now on, it is one of the most horrible things you can do at this moment.

Just so you know, I donâ€™t want you to be my girlfriend or something. I just want to talk with you sometimes, and that itself will bring me lots of joy. If you ever have a crush on someone, you would know. After just talking 2 minutes to this person, will make you feel like you have achieved something very great right now! This is exactly how I feel towards you! 

So, please, I would like it if you sometimes talk with me. At least more often than this. Trust me, just looking at your beautiful face and talking to such an attractive and charming person is one of the best and beautiful experiences I can ever get. Trust me, your face looks extraordinarily cute and beautiful at the same time. And the way you speak is just so cute and charming! I am not joking, trust me.

When I come to Karate (or Drawing), the first thing that I do is look whether you are present (What I find saddening is that your attendance is so low on Karate!). This might seem as some overhyped flattery, but it is absolutely not. I just appreciate you. I know that I am not such an amazing person to talk much with you, but please talk to me sometimes.

  </div>

<h2 style="margin-top:60px">Reply</h2>

<div id="replyBox">
<textarea id="msg" placeholder="Write somethingâ€¦" rows="3"></textarea>
<button onclick="send()">Send</button>
</div>

<div id="messages"></div>

<style>
#replyBox{
max-width:900px;
margin:auto;
display:flex;
gap:10px;
}
#replyBox textarea{
flex:1;
padding:12px;
border-radius:12px;
border:1px solid #ccc;
font-family:Poppins;
}
#replyBox button{
padding:12px 20px;
border-radius:12px;
border:none;
background:#667eea;
color:white;
}
#messages{
max-width:900px;
margin:30px auto;
font-size:15px;
}
.msg{
background:#f4f4f6;
padding:12px 16px;
border-radius:12px;
margin-bottom:10px;
}
</style>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbxDcF74J-r0Ik0sgop1Z8RBl8mlJbNtex-ORFgVtX5KbsV3ElQHO2-47u6rtCr9Ay7DRA/exec";

function send(){
const text = msg.value.trim();
if(!text) return;
fetch(API_URL,{method:"POST",body:new URLSearchParams({message:text})})
.then(()=>{msg.value=""; load();});
}

function load(){
fetch(API_URL)
.then(r=>r.json())
.then(data=>{
messages.innerHTML = data.map(
r=>`<div class="msg">${r[1]}</div>`
).join("");
});
}

load();
</script>
  
  <button class="logout" onclick="logout()">Logout</button>
</div>

<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>

<script>
document.body.classList.add('loaded');

firebase.initializeApp({
  apiKey:"AIzaSyCstIC5AQdLfJRae0CDr6TmMUQK3C4qBQg",
  authDomain:"dipshikha-1db64.firebaseapp.com",
  projectId:"dipshikha-1db64",
  appId:"1:1011494461374:web:82b05a5dc16c543b5d23ef"
});
const auth=firebase.auth();

let fails=0,maxFails=7;

document.addEventListener('keydown',e=>{
  if(e.key==='Enter'&&!contentCard.classList.contains('show'))login();
  if(e.key==='Escape'&&contentCard.classList.contains('show'))logout();
});
password.addEventListener('keyup',e=>{
  capsWarning.style.display=e.getModifierState('CapsLock')?'block':'none';
});

function togglePassword(e){
  password.type=password.type==='password'?'text':'password';
  e.target.textContent=password.type==='password'?'Show':'Hide';
}

function login(){
  if(fails>=maxFails){errorMsg.textContent='Try again later';return}
  btnText.textContent='Signing in';spinner.style.display='block';
  auth.setPersistence(rememberMe.checked?
    firebase.auth.Auth.Persistence.LOCAL:
    firebase.auth.Auth.Persistence.SESSION)
  .then(()=>auth.signInWithEmailAndPassword(username.value,password.value))
  .then(()=>showContent())
  .catch(err=>{
    fails++;errorMsg.textContent=err.message;
    spinner.style.display='none';btnText.textContent='Continue';
    loginBox.classList.add('shake');setTimeout(()=>loginBox.classList.remove('shake'),400);
  });
}

function showContent(){
  loginCard.classList.add('hidden');
  contentCard.classList.remove('hidden');
  setTimeout(()=>contentCard.classList.add('show'),50);
  setTimeout(()=>{
    skeleton.classList.add('hidden');
    mainText.classList.remove('hidden');
  },800);
}

function logout(){auth.signOut().then(()=>location.reload())}

function searchText(q){
  const text=mainText.innerText;
  if(!q){mainText.innerHTML=text;return}
  mainText.innerHTML=text.replaceAll(q,`<mark>${q}</mark>`);
}

function toggleTheme(){
  const t=document.documentElement.dataset.theme;
  document.documentElement.dataset.theme=t==='dark'?'':'dark';
  localStorage.theme=document.documentElement.dataset.theme;
}

if(localStorage.theme)document.documentElement.dataset.theme=localStorage.theme;
auth.onAuthStateChanged(u=>u&&showContent());
</script>

</body>
</html>
